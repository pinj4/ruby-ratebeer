<%= javascript_include_tag "turbo", type: "module" %>

<h2>List of ratings</h2>
<p>Number of ratings: <%= @ratings.count %></p>
<%= link_to "New rating", new_rating_path, class:"btn btn-primary"%>

<p>
<h4>Best beers:</h4>
<table class="table table-striped table-hover">
  <thead>
    <th scope="col">Beer</th>
    <th scope="col">Average rating</th>
  </thead>
  <tbody>
  <% @top_beers.each do |beer| %>
      <tr>
        <td><%= beer.name %></td>
        <td><%= beer.average_rating %></td>
      </tr>
  <% end %>
  </tbody>
</table>
</p>

<p>
<h4>Best breweries:</h4>
<table class="table table-striped table-hover">
  <thead>
    <th scope="col">Brewery</th>
    <th scope="col">Average rating</th>
  </thead>
  <tbody>
  <% @top_breweries.each do |brewery| %>
      <tr>
        <td><%= brewery.name %></td>
        <td><%= brewery.average_rating %></td>
      </tr>
  <% end %>
  </tbody>
</table>
</p>

<p>
<h4>Best styles:</h4>
<table class="table table-striped table-hover">
  <thead>
    <th scope="col">Style</th>
    <th scope="col">Average rating</th>
  </thead>
  <tbody>
  <% @top_styles.each do |style| %>
      <tr>
        <td><%= style.name %></td>
        <td><%= style.average_rating %></td>
      </tr>
  <% end %>
  </tbody>
</table>
</p>

<p>
<h4>Most active users</h4>
<table class="table table-striped table-hover">
  <thead>
    <th scope="col">User</th>
    <th scope="col">Ratings</th>
  </thead>
  <tbody>
  <% @active_users.each do |user| %>
      <tr>
        <td><%= user.username %></td>
        <td><%= user.ratings_count %></td>
      </tr>
  <% end %>
  </tbody>
</table>
</p>

<p>
<h4>Recent ratings:</h4>
<table class="table table-striped table-hover">
  <thead>
    <th scope="col">Beer</th>
    <th scope="col">rating</th>
    <th scope="col">rated by</th>
  </thead>
  <tbody>
  <% @recent_ratings.each do |rating| %>
      <tr>
        <td><%= rating.beer %></td>
        <td><%= rating.score %></td>
        <td><%= link_to rating.user.to_s, user_path(rating.user_id) %></td>
      </tr>
  <% end %>
  </tbody>
</table>
</p>
